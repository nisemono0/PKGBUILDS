# Maintainer: Ren Tatsumoto <tatsu at autistici dot org>
# Original https://aur.archlinux.org/packages/transformers_ocr
# Patched to work with scrot by me

_pkgname=transformers_ocr
pkgname=transformers_ocr-scrot
pkgver=0.15
pkgrel=1
pkgdesc="An OCR tool for manga using maim with Transformers. (Patched to work with scrot)"
arch=(any)
url="https://github.com/Ajatt-Tools/transformers_ocr"
license=("GPL3")
source=(
    "${_pkgname}-${pkgver}.tar.gz::${url}/archive/refs/tags/v${pkgver}.tar.gz"
    "SCROT_PATCH.diff"
)
depends=('python' 'python-pip' 'libnotify')
optdepends=(
	 'maim: taking screenshots on Xorg'
     'scrot: taking screenshots on Xort (alternative to maim)'
	 'xclip: copying to the clipboard on Xorg'

	 'grim: taking screenshots on Wayland'
	 'slurp: selecting a region on Wayland'
	 'wl-clipboard: copying to the clipboard on Wayland'

	 'gnome-screenshot: taking screenshots on GNOME'
	 'spectacle: taking screenshots on KDE'
)
conflicts=("transformers_ocr")
provides=("transformers_ocr")
sha256sums=(
    'e59abe2fba28aaeccbff0fde36a757cda3d447430f91077beaf10ed528b86a55'
    'SKIP'
)

prepare() {
    cd -- "${_pkgname}-${pkgver}"
    patch --strip=1 --input="${srcdir}/SCROT_PATCH.diff" "src/transformers_ocr.py"
}

package() {
	cd -- "${_pkgname}-${pkgver}"
	make PREFIX="${pkgdir}/usr" install
}
